options:
	gui: (metadata tag "heartofearthcraft" of player)
#on region enter:
	#if "%region%" contains "HeartEntrance":
		#if 40 > {poziom::%player%}:
			#cancel event
#if player's tool's name contains "Jet-vac":
#set {_name} to uncolored name of player's tool
#set metadata tag "heartofearthcraft" of player to chest inventory with 2 rows named "HoE Traits: %{_name}%"
#set slot 0, 8, 9, 10, 16 and 17 of {@gui} to black stained glass pane named " "
#open {@gui} to player
variables:
	{heartlevel::%player%} = 0

on rightclick on black concrete:
	if {poziom::%player%} >= 40:
		set {_x} to "%region at player%"
		if {_x} contains "Spawn":
			if player's x-coordinate < -1208:
				if player's z-coordinate < -1827:
					teleport the player to location(-1209.3, 66.5, -1828.3, world "world")
					play sound "block.piston.extend" with volume 3 and pitch 1 at clicked block
on command:
	if 40 > {poziom::%player%}:
		if full command contains "teleport", "tppos", "tpr", "tprandom", "tp2p" or "tp":
			loop all players:
				if full command contains "%loop-player%":
					if 40 > {poziom::%player%}:
						set {_x} to "%region at loop-player%"
						if {_x} contains "ChamberofHeart":
							cancel event
							if {language::%player%} = "English":
								send "&cThe person you're trying to teleport to is in a forbidden area for you." to player
							else:
								send "&cOsoba do której próbujesz się przeteleportować przebywa teraz w zakazanym dla ciebie miejscu." to player
command /interact [<text>] [<number>]:
	trigger:
		if arg-1 = "Magni":
			if arg-2 = 1:
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>I discovered the presence of something incredibly powerful: our world's blood." to player
				play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 4 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Through years of activity, the lands of the server have become misshapen and our world started to bleed." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 5 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>The distortion has caused our very world to beam with its blood called the Azerite." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 6 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>The full potential of this material has not yet been discovered, still I worry that it may be put to malicious use in no time." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 6 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>That is why I called you here. I want you to retrieve as much of this material as possible before it is misued by anyone with ill intentions." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 6 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>For this task, you will need something of major significance. I bestow upon you the most powerful artifact our server has ever seen: the <##e8ce81>Heart of Earthcraft<##7aa7f5>." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 6 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>The <##e8ce81>Heart of Earthcraft <##7aa7f5>is a necklace entrusted to only the worthiest heroes. It can absorb Azerite and heal its wounds through it while gaining power." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 6 seconds
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Equipping this artifact will empower you and increase your combat potency to levels you have not yet dabbled with." to player
				play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				wait 2 seconds
				play sound "block.note_block.pling" with volume 4 and pitch 2 to player
				send " " to player
				send formatted "                                   <command:/interact Magni 2><tooltip:&fClick to take the Heart of Earthcraft from Magni.>&a[Obtain the Heart of Earthcraft]                                   " to player
				send " " to player
			if arg-2 = 2:
				set {magnitalk::%player%} to true
				#if {language::%player%} = "English":
				play sound "entity.wandering_trader.reappeared" with volume 5 and pitch 1 to player
				play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
				send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>&o*You take the artifact from Magni* &r<##7aa7f5>Now absorb the Azerite around the chamber into the Heart. Then unleash the amulet's power to seal the crack in the center of the seal." to player
				send "&7(Right click to equip the artifact)" to player
				set {_heart} to gold nugget named "<##e8ce81>Heart of Earthcraft" with lore "<##fdd002>Item Level 280" and "&fSoulbound" and "&f+104 Health" and "<##00ff00>+129 Critical Hit" and "<##00ff00>+129 Haste" and "<##00ff00>+129 Mastery" and " " with nbt from "{CustomModelData:10}"
				set {_numbers::*} to 1, 6, 13, 21, 29, 36, 45, 54, 61, 70, 78 and 86
				loop 12 times:
					add "&7- Unlocked at Heart Level %{_numbers::%loop-number%}%" to lore of {_heart}
				add " " and "<##00ff00>Equip: Harnesses the energy of raw" and "<##00ff00>Azerite, awakening exceptional pieces" and "<##00ff00>of armor that possess latent powers." and " " and "<##fdd002>''A living symbol of hope, borne by the" and "<##fdd002>champions of a dying planet. The fate" and "<##fdd002>of Earthcraft will be shared by all its" and "<##fdd002>children.''" and "<##00ff00><Shift Right Click to View Traits>" to lore of {_heart}
				add "&8Soulbound to %player%" to lore of {_heart}
				if player has space for {_heart}:
					give {_heart} to player
				else:	
					drop {_heart} at player
				set {azeritequest::%player%} to true
				#else:
				#	set {_heart} to gold nugget

on rightclick:
	if {azeritequest::%player%} is true:
		if player's chestplate is golden nugget:
			if name of player's chestplate contains "Heart of Earthcraft" or "Serce Earthcrafta":
				if line 30 of lore of player's chestplate contains player's name:
					if clicked block is not air:
						if "%region at clicked block%" contains "crystal1":
							#loop blocks in region "crystal1":        #jak chcemy żeby bloki wyświetlały się jako air dla gracza
							#	if loop-block is not air:
							#		add loop-block to {azeritecrystals::%player%}
							if {kliknieteazeritequest::%player%::*} does not contain "crystal1":
								add "crystal1" to {kliknieteazeritequest::%player%::*}
								play sound "azerite.loop" with volume 1 and pitch 1 at player
								AzeriteChannel(player, location of clicked block)
								wait 4 seconds
								stop sound "azerite.loop" for all players
								play sound "azerite.cast" with volume 1 and pitch 1 at player
								play sound "azerite.collect" with volume 1 and pitch 1 at player
								send "<##e8ce81>[Heart of Earthcraft] <##fdd002>gains 88 Artifact Power." to player
								add 87.5 to {azerite::%player%}
						if "%region at clicked block%" contains "crystal2":
							if {kliknieteazeritequest::%player%::*} does not contain "crystal2":
								add "crystal2" to {kliknieteazeritequest::%player%::*}
								play sound "azerite.loop" with volume 1 and pitch 1 at player
								AzeriteChannel(player, location of clicked block)
								wait 4 seconds
								stop sound "azerite.loop" for all players
								play sound "azerite.cast" with volume 1 and pitch 1 at player
								play sound "azerite.collect" with volume 1 and pitch 1 at player
								send "<##e8ce81>[Heart of Earthcraft] <##fdd002>gains 88 Artifact Power." to player
								add 87.5 to {azerite::%player%}
						if "%region at clicked block%" contains "crystal3":
							if {kliknieteazeritequest::%player%::*} does not contain "crystal3":
								add "crystal3" to {kliknieteazeritequest::%player%::*}
								play sound "azerite.loop" with volume 1 and pitch 1 at player
								AzeriteChannel(player, location of clicked block)
								wait 4 seconds
								stop sound "azerite.loop" for all players
								play sound "azerite.cast" with volume 1 and pitch 1 at player
								play sound "azerite.collect" with volume 1 and pitch 1 at player
								send "<##e8ce81>[Heart of Earthcraft] <##fdd002>gains 88 Artifact Power." to player
								add 87.5 to {azerite::%player%}
						if "%region at clicked block%" contains "crystal4":
							if {kliknieteazeritequest::%player%::*} does not contain "crystal4":
								add "crystal4" to {kliknieteazeritequest::%player%::*}
								play sound "azerite.loop" with volume 1 and pitch 1 at player
								AzeriteChannel(player, location of clicked block)
								wait 4 seconds
								stop sound "azerite.loop" for all players
								play sound "azerite.cast" with volume 1 and pitch 1 at player
								play sound "azerite.collect" with volume 1 and pitch 1 at player
								send "<##e8ce81>[Heart of Earthcraft] <##fdd002>gains 88 Artifact Power." to player
								add 87.5 to {azerite::%player%}
						if {azerite::%player%} >= 350:
							set {azeritequest::%player%} to false
							clear {kliknieteazeritequest::%player%::*}
							send title "&f <##e8ce81>Heart of Earthcraft" with subtitle "     <##00ff00>Power Increased <##00ff00>to Level 1" to player for 4 seconds with fade in 1 second and fade out 1 second
							set {heartlevel::%player%} to 1
							set line 8 of lore of player's chestplate to "&f- A new power is available."
							send "<##00ff00>A new Heart of Earthcraft power is available." to player
							send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Now seal the crack in the center!" to player
							set {itemlevelheart::%player%} to 280
							stop
function AzeriteChannel(p: player, l: location):
	loop 40 times:
		#set {_pid} to random 8 char string from charset `0-9`
		set {_loc} to location of {_p}
		increase y-coordinate of {_loc} by 1.4
		#ZAMIENIĆ PARTICLE JAK BĘDZIE SKDRAGON
		set {_vec} to vector between {_loc} and {_l}
		loop round(distance between {_loc} and {_l}) / 0.5 times:
			set {_vec} to vector between {_loc} and {_l}
			set vector length of {_vec} to loop-value-2 * 0.5
			draw 1 of dust using dustOption((rgb 132, 175, 245), 1) at {_loc} ~ {_vec}
			draw 1 of dust using dustOption((rgb 242, 204, 121), 1) at {_loc} ~ {_vec}
		wait 2 ticks
		#drawLine particle redstone, RGB 132, 175, 245, center location of {_loc}, target location of {_l}, id "%{_pid}%", rainbowMode false, solid true, density 25, length 0, zigZag count 5, height 0, visibleRange 32, displacementXYZ 0, 1, 0, pulseDelay 3
		#drawLine particle redstone, RGB 242, 204, 121, center location of {_loc}, target location of {_l}, id "%{_pid}%2", rainbowMode false, solid true, density 25, length 0, zigZag count 5, height 0, visibleRange 32, displacementXYZ 0, 1, 0, pulseDelay 3
		#wait 2 ticks
		#stop effect "%{_pid}%"
		#stopEffect "%{_pid}%2"
		
function AzeriteBurst(p: player, l: location, l2: location):
	#set {_pid} to random 8 char string from charset `0-9`
	#ZAMIENIĆ PARTICLE JAK BĘDZIE SKDRAGON
	set {_vec} to vector between {_l} and {_l2}
	loop round(distance between {_l} and {_l2}) / 0.25 times:
		set {_vec} to vector between {_l} and {_l2}
		set vector length of {_vec} to loop-value * 0.25
		draw 1 of dust using dustOption((rgb 132, 175, 245), 1) at {_l} ~ {_vec}
		draw 1 of dust using dustOption((rgb 242, 204, 121), 1) at {_l} ~ {_vec}
	#drawArc particle "redstone", RGB 132, 175, 245, center {_l}, target location of {_l2}, id "%{_pid}%", rainbowMode false, density 50, height 2, pitchMultiplier 1, visibleRange 30
	#drawArc particle "redstone", RGB 245, 226, 132, center {_l}, target location of {_l2}, id "%{_pid}%2", rainbowMode false, density 50, height 2, pitchMultiplier 1, visibleRange 30
	#wait 6 ticks
	#stopEffect "%{_pid}%"
	#stopEffect "%{_pid}%2"

on rightclick on tinted glass:
	if "%region at player%" contains "ChamberofHeart":
		if {azeritequest::%player%} = false:
			clear {azeritequest::%player%}
			set {stun::%player%} to true
			loop all blocks in radius 8 around the player:
				add location of loop-block to {_blocks::*}
			play sound "azerite.loop" with volume 1 and pitch 1 at player
			wait 3 seconds
			send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>That's it, I think it's working!" to player	
			play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
			wait 2 seconds
			play sound "azerite.loop" with volume 1 and pitch 1 at player
			wait 2 seconds
			send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Keep going! Just a wee bit more..." to player
			play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
			wait 3 seconds
			send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>You did it, champion! The chamber is secure!" to player
			play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
			stop sound "azerite.loop" for all players
			set {_p} to 1
			clear {stun::%player%}
			loop 20 times:
				play sound "azerite.cast" with volume 1 and pitch 1 at player
				add 0.05 to {_p}
				set {_loc} to location of player
				set {_r} to a random element of {_blocks::*}
				AzeriteBurst(player, {_loc}, {_r})
				wait 10 ticks
function HeartLevelup(p: player, n: number):
	stop
	add {_n} to {azerite::%{_p}%}
	if 50 >= {_n}:
		send " <##fdd002>You obtain: <##00ff00>[Tiny Azerite Splinter]<##fdd002>." to {_p}
	if {_n} > 50:
		if {_n} < 150:
			send " <##fdd002>You obtain: <##00ff00>[Small Azerite Shard]<##fdd002>." to {_p}
		else:
			if 200 >= {_n}:
				send " <##fdd002>You obtain: <##00ff00>[Small Azerite Cluster]<##fdd002>." to {_p}
			else:
				if {_n} <= 300:
					send " <##fdd002>You obtain: <##0070dd>[Glowing Azerite Crystal]<##fdd002>." to {_p}
				if {_n} > 300:
					if {_n} < 425:
						send " <##fdd002>You obtain: <##0070dd>[Glowing Azerite]<##fdd002>." to {_p}
					else:
						if {_n} < 500:
							send " <##fdd002>You obtain: <##0070dd>[Glowing Azerite Geode]<##fdd002>." to {_p}
						else:
							if {_n} < 651:
								send " <##fdd002>You obtain: <##a335ee>[Glowing Azerite Fragment]<##fdd002>." to {_p}
							else:
								if {_n} = 750:
									send " <##fdd002>You obtain: <##a335ee>[Radiant Azerite Core]<##fdd002>." to {_p}
								if {_n} = 3000:
									send " <##fdd002>You obtain: <##a335ee>[Humming Azerite Heart]<##fdd002>." to {_p}
	send "<##e8ce81>[Heart of Earthcraft] <##fdd002>gains %{_n}% Artifact Power." to {_p}
	play sound "azerite.collect" with volume 1 and pitch 1 to {_p}
	if 13 >= {heartlevel::%{_p}%}:
		if {heartlevel::%{_p}%} = 0:
			set {_azerite} to 350
		if {heartlevel::%{_p}%} = 1:
			set {_azerite} to 400
		if {heartlevel::%{_p}%} = 2:
			set {_azerite} to 450
		if {heartlevel::%{_p}%} = 3:
			set {_azerite} to 500
		if {heartlevel::%{_p}%} = 4:
			set {_azerite} to 550
		if {heartlevel::%{_p}%} = 5:
			set {_azerite} to 600
		if {heartlevel::%{_p}%} = 6:
			set {_azerite} to 650
		if {heartlevel::%{_p}%} = 7:
			set {_azerite} to 700
		if {heartlevel::%{_p}%} = 8:
			set {_azerite} to 1050
		if {heartlevel::%{_p}%} = 9:
			set {_azerite} to 1580
		if {heartlevel::%{_p}%} = 10:
			set {_azerite} to 2370
		if {heartlevel::%{_p}%} = 11:
			set {_azerite} to 3560
		if {heartlevel::%{_p}%} = 12:
			set {_azerite} to 5350
		if {heartlevel::%{_p}%} = 13:
			set {_azerite} to 8000			
	else:
		set {_azerite} to 10400
		loop ({heartlevel::%{_p}%}-14) times:
			set {_azerite} to ({_azerite}*1.3)/50
			set {_rawnumber} to rounded down {_azerite}
			set {_number} to {_azerite} - {_rawnumber}
			if {_number} > 0.45:
				set {_azerite} to (rounded up {_azerite})*50
			else:
				set {_azerite} to (rounded down {_azerite})*50
	if {azerite::%{_p}%} >= {_azerite}:
		if {heartlevel::%{_p}%} is not 0:
			remove {_azerite} from {azerite::%{_p}%}
			add 1 to {heartlevel::%{_p}%}
			play sound "azerite.cast" with volume 2 and pitch 1 at {_p}
			send title "&f <##e8ce81>Heart of Earthcraft" with subtitle "     <##00ff00>Power Increased <##00ff00>to Level %{heartlevel::%{_p}%}%" to {_p} for 4 seconds with fade in 1 second and fade out 1 second
			add 2 to {itemlevelheart::%{_p}%}
			if {heartlevel::%{_p}%} = 1 or 6 or 13 or 21 or 29 or 36 or 45 or 54 or 61 or 70 or 78 or 86:
				send "<##00ff00>A new Heart of Earthcraft power is available." to {_p}
				set {_newpower} to {heartlevel::%{_p}%}
			set {_bonushealth} to 104 + (rounded down (1.2*({heartlevel::%{_p}%}-1)))
			set {_bonusstaty} to 129 + (rounded down (1.4*({heartlevel::%{_p}%}-1)))
			if {_p}'s chestplate is golden nugget:
				if name of {_p}'s chestplate contains "<##e8ce81>Heart of Earthcraft" or "<##e8ce81>Serce Earthcrafta":
					if line 30 of lore of {_p}'s chestplate contains {_p}'s name:
						set line 1 of lore of {_p}'s chestplate to "<##fdd002>Item Level %{itemlevelheart::%{_p}%}%"
						set line 3 of lore of {_p}'s chestplate to "&f+%{_bonushealth}% Health"
						set line 4 of lore of {_p}'s chestplate to "<##00ff00>+%{_bonusstaty}% Critical Hit"
						set line 5 of lore of {_p}'s chestplate to "<##00ff00>+%{_bonusstaty}% Haste"
						set line 6 of lore of {_p}'s chestplate to "<##00ff00>+%{_bonusstaty}% Mastery"
						if {_newpower} = 6:
							set line 9 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 13:
							set line 10 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 21:
							set line 11 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 29:
							set line 12 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 36:
							set line 13 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 45:
							set line 14 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 54:
							set line 15 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 61:
							set line 16 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 70:
							set line 17 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 78:
							set line 18 of lore of {_p}'s chestplate to "&f- A new power is available."
						if {_newpower} = 86:
							set line 19 of lore of {_p}'s chestplate to "&f- A new power is available."
						set {_true} to true
			if {_true} is not true:
				loop all items in the inventory of {_p}:
					if loop-value is a golden nugget:
						if name of loop-value = "<##e8ce81>Heart of Earthcraft" or "<##e8ce81>Serce Earthcrafta":
							if line 30 of lore of loop-value contains {_p}'s name:
								set line 1 of lore of loop-value to "<##fdd002>Item Level %{itemlevelheart::%{_p}%}%"
								set line 3 of lore of loop-value to "&f+%{_bonushealth}% Health"
								set line 4 of lore of loop-value to "<##00ff00>+%{_bonusstaty}% Critical Hit"
								set line 5 of lore of loop-value to "<##00ff00>+%{_bonusstaty}% Haste"
								set line 6 of lore of loop-value to "<##00ff00>+%{_bonusstaty}% Mastery"
								if {_newpower} = 6:
									set line 9 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 13:
									set line 10 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 21:
									set line 11 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 29:
									set line 12 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 36:
									set line 13 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 45:
									set line 14 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 54:
									set line 15 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 61:
									set line 16 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 70:
									set line 17 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 78:
									set line 18 of lore of loop-value to "&f- A new power is available."
								if {_newpower} = 86:
									set line 19 of lore of loop-value to "&f- A new power is available."
								set {_true} to true
								stop
			if {_true} is not true:
				set {heartlvlupclaim::%{_p}%} to true
on rightclick:
	if clicked player's name = "Magni":
		if {poziom::%player%} >= 40:
			if {magni::%clicked player%} is true:
				if metadata value "ECEngaged" of player is not set:
					if player is not sneaking:
						if {heartofec::%player%} is not set:
							if {magnitalk::%player%} is not set:
								if cooldown "magniclick%player%" is finished:
									create cooldown "magniclick%player%" for 3 seconds
									wait 0.5 seconds
									play sound "entity.wandering_trader.reappeared" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>You're here! I have been looking for you!" to player
									wait 2 seconds
									play sound "block.note_block.pling" with volume 4 and pitch 2 to player
									send " " to player
									send formatted "                                   <command:/interact Magni 1><tooltip:&fClick to ask Magni what happened.>&a[Ask what happened]                                   " to player
									send " " to player
							else:
								if {azeritequest::%player%} is not set:
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>The chamber has been restored. It seems that the amulet has gained in power and can now hold a powerful Trait." to player
									play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									wait 5 seconds
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Traits are potent powers that can be found all across the server and obtained from different sources, including mining or combat. Each Trait has its own unique effect, which can grow stronger as you upgrade it." to player 
									play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									wait 8 seconds
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>I will grant you one of your Card's Traits as a reward for restoring balance in this chamber." to player
									play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									wait 4 seconds
									play sound "azerite.loop" with volume 1 and pitch 1 to player
									set {_x} to {wybranystarter::%player%}
									if {_x} = "Glaceon":
										set {_trait} to "Flash Freeze"
										set {_color} to "<##4bbfe2>%{_x}%"
									if {_x} = "Vaporeon":
										set {_trait} to "Bound Molecules"
										set {_color} to "<##7cafbf>%{_x}%"
									if {_x} = "Umbreon":
										set {_trait} to "Shadow Cloak"
										set {_color} to "<##555555>%{_x}%"
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>&o*Magni infuses your <##e8ce81>&oHeart of Earthcraft <##7aa7f5>&owith %{_trait}%.*" to player
									if {trait::%{_x}%::%{_trait}%::%player%} is not set:
										if {trait::%{_x}%::%{_trait}%::%player%} is not set:
											set {_color2} to "<##00ff00>%{_trait}%" 		#RANK 1
										add 1 to {trait::%{_x}%::%{_trait}%::%player%}
										if {language::%player%} = "English":
											send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{%{_trait}%}% %{_color2}%&6! &6(%{_color}%&6)" to player
										else:
											send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{%{_trait}%}% %{_color2}%&6)" to player
										play sound "entity.player.levelup" with volume 5 and pitch 1.2 at player
									set {stun::%player%} to true
									wait 4 seconds
									clear {stun::%player%}
									stop sound "azerite.loop" for player
									play sound "azerite.cast" with volume 1 and pitch 1 to player
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>This Trait will enhance one or more of your abilities and make them stronger." to player
									play sound "entity.wandering_trader.yes" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									wait 6 seconds
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Your <##e8ce81>Heart of Earthcraft <##7aa7f5>can have up to 12 Traits active and each Card has a set of 10 unique Traits. A maximum of 3 identical Traits may be equipped." to player
									play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									wait 8 seconds
									send "<##7aa7f5>&8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>It is now time to begin your adventure. If you wish to change or equip Traits, you can do so at any time by visiting me in my chamber." to player
									play sound "entity.wandering_trader.ambient" with volume 5 and pitch 1 to player
									play sound "entity.villager.work_cartographer" with volume 3 and pitch 1 to player
									set {heartofec::%player%} to true
									add 1 to {heartplayer::%player%}
									achievement("heartplayer", player, 1, "osiagniecie.heart", "Otrzymaj Serce Earthcrafta", "Miej Serce", "Obtain the Heart of Earthcraft", "Have a Heart")
									clear {heartplayer::%player%}
						else if {heartofec::%player%} is true:
							if {traitchat::%player%} is set:
								clear {traitchat::%player%}
							if name of player's chestplate contains "Serce Earthcrafta" or "Heart of Earthcraft":
								if line 30 of lore of player's chestplate contains player's name:
									play sound "azerite.rotate" with volume 1 and pitch 1 to player
									set metadata tag "heartofearthcraft" of player to chest inventory with 2 rows named "HoE Traits"
									if {language::%player%} = "English":
										set {_slotunl} to "&7This slot unlocks at%nl%&7Heart of Earthcraft level"
										set {_slotname} to "&8Slot locked"
										set {_dostraits} to "&7Unlocked Traits:"
										set {_traitchange} to "&f<Click to choose or change trait>"
									else:
										set {_slotunl} to "&7Ten slot odblokowuje się na%nl%&7poziomie Serca Earthcrafta"
										set {_slotname} to "&8Slot nieodblokowany"
										set {_dostraits} to "&7Odblokowane Traits:"
										set {_traitchange} to "&f<Kliknij, by wybrać lub zmienić trait>"
									set {_loopnumber} to 1
									loop 12 times:
										if {_loopnumber} >= 11:
											set slot {_loopnumber} of {@gui} to light blue stained glass pane named "%{kartacolor::%player%}%Trait %{_loopnumber}-3%" with lore "&7%{_dostraits}%%nl%"
										else:
											set slot {_loopnumber} of {@gui} to light blue stained glass pane named "%{kartacolor::%player%}%Trait %{_loopnumber}%" with lore "&7%{_dostraits}%%nl%"
										add 1 to {_loopnumber}
										if {_loopnumber} is 8:
											add 3 to {_loopnumber}
										if {_loopnumber} = 16:
											stop loop
									set {_id} to line 18 of lore of {karta::%player%}
									if {heartlevel::%player%} >= 1:
										if {hearttrait::%player%::1} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::1}
												if loop-value contains uncolored {hearttrait::%player%::1}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 1 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 1 of {@gui}
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 1 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 1 of {@gui}
									else:
										set slot 1 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 1."
									if {heartlevel::%player%} >= 6:
										if {hearttrait::%player%::2} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::2}
												if loop-value contains uncolored {hearttrait::%player%::2}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 2 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 2 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 2 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 2 of {@gui}
									else:
										set slot 2 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 6."
									if {heartlevel::%player%} >= 13:
										if {hearttrait::%player%::3} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::3}
												if loop-value contains uncolored {hearttrait::%player%::3}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 3 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 3 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 3 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 3 of {@gui}
									else:
										set slot 3 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 13."
									if {heartlevel::%player%} >= 21:
										if {hearttrait::%player%::4} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::4}
												if loop-value contains uncolored {hearttrait::%player%::4}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 4 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 4 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 4 of {@gui}
										add "%nl%%{_traitchange}%" to lore of slot 4 of {@gui}
									else:
										set slot 4 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 21."
									if {heartlevel::%player%} >= 29:
										if {hearttrait::%player%::5} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::5}
												if loop-value contains uncolored {hearttrait::%player%::5}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 5 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 5 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 5 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 5 of {@gui}
									else:
										set slot 5 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 29."
									if {heartlevel::%player%} >= 36:
										if {hearttrait::%player%::6} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::6}
												if loop-value contains uncolored {hearttrait::%player%::6}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 6 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 6 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 6 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 6 of {@gui}
									else:
										set slot 6 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 36."
									if {heartlevel::%player%} >= 45:
										if {hearttrait::%player%::7} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::7}
												if loop-value contains uncolored {hearttrait::%player%::7}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 7 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 7 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 7 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 7 of {@gui}
									else:
										set slot 7 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 45."
									if {heartlevel::%player%} >= 54:
										if {hearttrait::%player%::8} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::8}
												if loop-value contains uncolored {hearttrait::%player%::8}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 11 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 11 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 11 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 11 of {@gui}
									else:
										set slot 11 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 54."
									if {heartlevel::%player%} >= 61:
										if {hearttrait::%player%::9} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::9}
												if loop-value contains uncolored {hearttrait::%player%::9}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 12 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 12 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 12 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 12 of {@gui}
									else:
										set slot 12 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 61."
									if {heartlevel::%player%} >= 70:
										if {hearttrait::%player%::10} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::10}
												if loop-value contains uncolored {hearttrait::%player%::10}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 13 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 13 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 13 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 13 of {@gui}
									else:
										set slot 13 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 70."
									if {heartlevel::%player%} >= 78:
										if {hearttrait::%player%::11} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::11}
												if loop-value contains uncolored {hearttrait::%player%::11}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 14 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 																	                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 14 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 14 of {@gui} 
										add "%nl%%{_traitchange}%" to lore of slot 14 of {@gui}
									else:
										set slot 14 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 78."
									if {heartlevel::%player%} >= 86:
										if {hearttrait::%player%::12} is set:
											loop {traits::%{kartaname::%player%}%::*}:
												set {_uncolor} to uncolored {hearttrait::%player%::12}
												if loop-value contains uncolored {hearttrait::%player%::12}:
													set {_opis} to loop-index
													stop loop
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 1:
												set {_color} to "&7(<##00ff00>U&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 2:
												set {_color} to "&7(<##0070dd>R&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 3:
												set {_color} to "&7(<##a335ee>E&7)"
											if {trait::%{kartaname::%player%}%::%{_uncolor}%::%player%} = 4:
												set {_color} to "&7(<##ff8000>L&7)"
											set lore of slot 15 of {@gui} to "%nl%&f%{%{_uncolor}%}% %{kartacolor::%player%}%%{_uncolor}% %{_color}%%nl%%{traits::%{kartaname::%player%}%::%{_opis}%::opis::%player%}%"
										else:
											loop {traits::%{kartaname::%player%}%::*}:                                                  #przechodzi przez każdy trait który posiada karta, np glaceon: whiteout, chain reaction
												if player is alive: 											                        #sprawdza czy karta ma ustawione (odblokowane) traity po kolei 1-12 {trait::id::1} {trait::id::2} itd. {trait::id::9} to w tym wypadku Whiteout bo jest 9 w kolejności    if {trait::%{_id}%::%loop-index%} is not set:
													if {trait::%{kartaname::%player%}%::%loop-value%::%player%} is set:   				#sprawdza czy karta posiada dany trait (czy jest odblokowany) {trait::Glaceon::NazwaTraitu::%player%}
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 1:
															set {_color} to "&7(<##00ff00>U&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 2:
															set {_color} to "&7(<##0070dd>R&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 3:
															set {_color} to "&7(<##a335ee>E&7)"
														if {trait::%{kartaname::%player%}%::%loop-value%::%player%} = 4:
															set {_color} to "&7(<##ff8000>L&7)"
														add "&7- %{kartacolor::%player%}%%loop-value% %{_color}%%nl%" to lore of slot 15 of {@gui} 
													else:
														add "&7- &8%loop-value%%nl%" to lore of slot 15 of {@gui}
										add "%nl%%{_traitchange}%" to lore of slot 15 of {@gui}
									else:
										set slot 15 of {@gui} to gray glass pane named "%{_slotname}%" with lore "%{_slotunl}% 86."
									set slot 0, 8, 9, 10, 16 and 17 of {@gui} to black stained glass pane named " "
									open {@gui} to player
									wait 1 seconds
									stop sound "azerite.rotate" for player
									play sound "azerite.collect" with volume 1 and pitch 1 at player
					else:
						if {language::%player%} = "English":
							send "<##a0dffa>>>> Please type the name of your prefered trait in chat to preview available upgrades." to player
							send "<##a0dffa>>>> Your message should start with a capital letter and should &nonly&r <##a0dffa>contain your prefered trait, example -> Wintertide." to player
							play sound "entity.experience_orb.pickup" with volume 3 and pitch 0.6 to player
						else:
							send "<##a0dffa>>>> Napisz nazwę wybranego traitu na chacie, by zobaczyć dostępne ulepszenia." to player
							send "<##a0dffa>>>> Wiadomość powinna zaczynać się z dużej litery, oraz zawierać &ntylko&r <##a0dffa>nazwę traitu, przykład -> Wintertide." to player
							play sound "entity.experience_orb.pickup" with volume 3 and pitch 0.6 to player
						set {traitupgradechat::%player%} to true
							
				else:
					if {language::%player%} = "English":
						send "&9You can't change your traits during combat." to player
						play sound "block.glass.break" with volume 3 and pitch 1 to player
					else:
						send "&9Nie możesz zmienić swoich traitów podczas walki." to player
						play sound "block.glass.break" with volume 3 and pitch 1 to player
#HEART LEVELUP SCREEN -> send player title "&f <##e8ce81>Heart of Earthcraft" with subtitle "     <##00ff00>Power Increased <##00ff00>to Level 95" for 4 seconds with 1 second fade in and 1 second fade out
on rightclick:
	if player's tool is redstone dust:
		if name of player = "llamadegree":
			send " " to player
			send " " to player
			send "&f&lAzerite" to player
			send "&7The blood of Earthcraft crystalizes into chunks of Azerite, an extremely potent and powerful material." to player
			send " " to player
			send "&7When you first acquire the &f<##e8ce81>Heart of Earthcraft&7, it begins at &fLevel 1 &7and &fItem Level 280&7." to player
			send "&7You are able to empower your &f&f<##e8ce81>Heart of Earthcraft &7by collecting &f&nAzerite&r&7, which will grant you Artifact Power. Artifact Power will &fautomatically be applied &7to your &f<##e8ce81>Heart of Earthcraft&7, so you won't have to worry about your inventory being full." to player
			send " " to player
			send "&7Upon reaching certain amounts of Artifact Power, your &f<##e8ce81>Heart of Earthcraft &7will level up and gain +2 item levels. Each level of your &f<##e8ce81>Heart of Earthcraft &7will require an increasing amount of Artifact Power:" to player
			send "   &7• The increase of AP needed from levels 1 to 10 on the &f<##e8ce81>Heart of Earthcraft &7is linear." to player
			send "   &7• After level 10, the AP needed to level up is 30%% higher than the previous level, which quickly%nl%&7   sets a soft-cap on how fast you can level up your &f<##e8ce81>Heart of Earthcraft&7." to player
			send " " to player
			send "&7There is much more to this complex system, please check out the following pages to learn more about the full system:" to player
			send " " to player
			send " " to player
#<##a0dffa>	
#1 - poziom 1
#2 - poziom 6
#3 - poziom 13
#4 - poziom 21
#5 - poziom 32
#6 - poziom 45
#7 - poziom 58
#8 - poziom 69
#9 - poziom 82
#10 - poziom 101
#11 - poziom 122
#12 - poziom 145

#1 - poziom 1
#2 - poziom 6
#3 - poziom 13
#4 - poziom 21
#5 - poziom 29
#6 - poziom 36
#7 - poziom 45
#8 - poziom 54
#9 - poziom 61
#10 - poziom 70
#11 - poziom 78
#12 - poziom 86

on inventory click:
	if current inventory of player is {@gui}:
		cancel event
	if event-slot is light blue glass pane:
		if name of event-slot contains "Trait":
			if lore of event-slot contains "&f<Click to choose or change trait>" or "&f<Kliknij, by wybrać lub zmienić trait>":
				set {_x::*} to name of event-slot split at " "
				set {_slot} to "%{_x::2}%" parsed as number
				play sound "ui.select" with volume 3 and pitch 0.6 to player
				teleport player to player's location
				set {traitslot::%player%} to {_slot}
				if {language::%player%} = "English":
					send "<##a0dffa>>>> In order to select a trait for slot %{_slot}%, type the name of your prefered trait in chat." to player
					send "<##a0dffa>>>> Your message should start with a capital letter and should &nonly&r <##a0dffa>contain your prefered trait, example -> Wintertide." 
					#if player's chestplate is not golden nugget:
					play sound "entity.experience_orb.pickup" with volume 3 and pitch 0.6 to player
					send "<##a0dffa>>>> Please make sure you have have your <##e8ce81>Heart of Earthcraft <##a0dffa>equipped in the process." to player
				else:
					send "<##a0dffa>>>> Aby wybrać trait dla slotu %{_slot}%, napisz nazwę wybranego traitu na chacie." to player
					send "<##a0dffa>>>> Wiadomość powinna zaczynać się z dużej litery, oraz zawierać &ntylko&r <##a0dffa>nazwę traitu, przykład -> Wintertide." to player
					#if player's chestplate is not golden nugget:
					play sound "entity.experience_orb.pickup" with volume 3 and pitch 0.6 to player
					send "<##a0dffa>>>> Upewnij się, że masz założone <##e8ce81>Serce Earthcrafta <##a0dffa>podczas wykonywania tej czynności." to player
				set {traitchat::%player%} to true
	if inventory action is instant move:
		if event-slot's name contains "Serce Earthcrafta" or "Heart of Earthcraft":
			if line 30 of lore of event-slot contains player's name:
				cancel event
				set {-cdhearttraits::%player%} to 6 seconds
				set {-hearttraits::cooldown::%player%} to difference between {-hearttraits::use::%player%} and now
				if {-hearttraits::cooldown::%player%} is less than {-cdhearttraits::%player%}:
					stop
				set {-hearttraits::use::%player%} to now
				play sound "azerite.rotate" with volume 5 and pitch 1 to player
				wait 2 seconds
				send " " to player
				if {language::%player%} = "English":
					send "%{kartaname::%player%}%'s Traits:" to player
				else:
					send "Traity %{kartaname::%player%}%:" to player
				loop 10 times:
					set {_x} to {traits::%{kartaname::%player%}%::%loop-number%}
					if {trait::%{kartaname::%player%}%::%{_x}%::%player%} = 1:
						set {_color} to "<##00ff00>%{_x}%"
					if {trait::%{kartaname::%player%}%::%{_x}%::%player%} = 2:
						set {_color} to "<##0070dd>%{_x}%"
					if {trait::%{kartaname::%player%}%::%{_x}%::%player%} = 3:
						set {_color} to "<##a335ee>%{_x}%"
					if {trait::%{kartaname::%player%}%::%{_x}%::%player%} = 4:
						set {_color} to "<##ff8000>%{_x}%"
					if {_color} is set:
						send "%{%{_x}%}% %{_color}%" to player
					else:
						send "%{%{_x}%}% &8%{_x}%" to player
					send "%{traits::%{kartaname::%player%}%::%loop-number%::opis::%player%}%" to player
					send " " to player
					clear {_x}
					clear {_color}
				send " " to player
				stop sound "azerite.rotate" for player
				play sound "azerite.collect" with volume 5 and pitch 1 to player
	#if inventory action is clone stack:
		#cancel event
on rightclick:
	if player's tool's name contains "Heart of Earthcraft":
		if player's tool is a gold nugget:
			if clicked player does not exist:
				if metadata value "ECEngaged" of player is not set:
					if line 30 of lore of player's tool contains player's name:
						set {_id} to line 18 of lore of {karta::%player%}
						loop 12 times:
							if line (7 + loop-number) of lore of player's tool does not contain "Unlocked at" or "Odblokowuje się":
								if {trait::%{_id}%::%loop-number%} is set:
									if line (7 + loop-number) of lore of player's tool does not contain {trait::%{_id}%::%loop-number%}:
										set line (7 + loop-number) of lore of player's tool to "&f%{%uncolored {trait::%{_id}%::%loop-number%}%}% %{trait::%{_id}%::%loop-number%}%"
								else:
									if {language::%player%} = "English":
										set line (7 + loop-number) of lore of player's tool to "&f- A new power is available."
									else:
										set line (7 + loop-number) of lore of player's tool to "&f- Nowa moc jest dostępna."
						set {_heart} to player's tool
						if player's chestplate is not set:
							set player's chestplate to {_heart}
						else:
							if player can hold player's chestplate:
								give player's chestplate to player
							else:
								drop player's chestplate at player
							set player's chestplate to {_heart}
						set {_r} to a random integer between 1 and 3
						play sound "azerite.trait_select" with volume 5 and pitch 1 to player
						if {heartlvlupclaim::%player%} is true:
							clear {heartlvlupclaim::%player%}
							set line 1 of lore of player's tool to "<##fdd002>Item Level %{itemlevelheart::%player%}%"
							set line 3 of lore of player's tool to "&f+%{_bonushealth}% Health %{itemlevelheart::%player%}%"
							set line 4 of lore of player's tool to "<##00ff00>+%{_bonusstaty}% Critical Hit %{itemlevelheart::%player%}%"
							set line 5 of lore of player's tool to "<##00ff00>+%{_bonusstaty}% Haste %{itemlevelheart::%player%}%"
							set line 6 of lore of player's tool to "<##00ff00>+%{_bonusstaty}% Mastery %{itemlevelheart::%player%}%"
						set {_health::*} to (uncolored line 3 of lore of player's tool) split at " "
						replace all "+" in {_health::1} with ""
						set {_health} to {_health::1} parsed as number
						set {_staty::*} to (uncolored line 4 of lore of player's tool) split at " "
						replace all "+" in {_staty::1} with ""
						set {_staty::1} to {_staty::1} parsed as number
						set {healthheart::%player%} to {_health}
						set {statyheart::%player%} to {_staty::1}
						add {_health} to {health::%player%}
						add {_staty::1} to {criticalhit::%player%}
						add {_staty::1} to {haste::%player%}
						add {_staty::1} to {mastery::%player%}
						set max health of player to 25 + ({zdrowie::%{_id}%}/5) + ({health::%player%}/5)
						set scaled health of player to 10
						remove 1 of player's tool from player
					else:
						set {_r::*} to line 30 of lore of player's tool split at " "
						if {language::%player%} = "English":
							send "&cThis item is soulbound to &f%{_r::3}%&c."
							play sound "block.glass.break" with volume 1 and pitch 2 to player
						else:
							send "&cTen przedmiot należy do &f%{_r::3}%&c."
							play sound "block.glass.break" with volume 1 and pitch 2 to player
				else:
					if {language::%player%} = "English":
						send "&c&oYou cannot equip the Heart of Earthcraft in combat." to player
					else:
						send "&c&oNie możesz założyć Serca Earthcrafta w walce." to player
on armor change:
	if old armor item is a gold nugget:
		if new armor item is not a gold nugget:
			if name of old armor item contains "Heart of Earthcraft" or "Serce Earthcrafta":
				if metadata value "ECEngaged" of player is not set:
					remove {healthheart::%player%} from {health::%player%}
					remove {statyheart::%player%} from {criticalhit::%player%}
					remove {statyheart::%player%} from {haste::%player%}
					remove {statyheart::%player%} from {mastery::%player%}
					clear {healthheart::%player%}
					clear {statyheart::%player%}
					set max health of player to 25 + ({health::%player%}/5)
					set scaled health of player to 10
function LoreTraitUpgrade(p: player, n: number, n2: number) :: string:
	if {language::%{_p}%} = "English":
		if {elementCard::%{_p}%} = "Ice" or "Lód":
			set {_reqitem} to {_n} of {esencjaloduEN}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjaloduEN}%%{_n}% %name of {esencjaloduEN}%"
		if {elementCard::%{_p}%} = "Water" or "Woda":
			set {_reqitem} to {_n} of {esencjawodyEN}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjawodyEN}%%{_n}% %name of {esencjawodyEN}%"
		if {elementCard::%{_p}%} = "Fire" or "Ogień":
			set {_reqitem} to {_n} of {esencjaogniaEN}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjaogniaEN}%%{_n}% %name of {esencjaogniaEN}%"
		if {elementCard::%{_p}%} = "Dark" or "Mrok":
			set {_reqitem} to {_n} of {esencjamrokuEN}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjamrokuEN}%%{_n}% %name of {esencjamrokuEN}%"
		if {elementCard::%{_p}%} = "Lava" or "Lawa":
			set {_reqitem} to {_n} of {esencjalawyEN}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjalawyEN}%%{_n}% %name of {esencjalawyEN}%"
	else:
		if {elementCard::%{_p}%} = "Ice" or "Lód":
			set {_reqitem} to {_n} of {esencjalodu}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjalodu}%%{_n}% %name of {esencjalodu}%"
		if {elementCard::%{_p}%} = "Water" or "Woda":
			set {_reqitem} to {_n} of {esencjawody}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjawody}%%{_n}% %name of {esencjawody}%"
		if {elementCard::%{_p}%} = "Fire" or "Ogień":
			set {_reqitem} to {_n} of {esencjaognia}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjaognia}%%{_n}% %name of {esencjaognia}%"
		if {elementCard::%{_p}%} = "Dark" or "Mrok":
			set {_reqitem} to {_n} of {esencjamroku}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjamroku}%%{_n}% %name of {esencjamroku}%"
		if {elementCard::%{_p}%} = "Lava" or "Lawa":
			set {_reqitem} to {_n} of {esencjalawy}
			set {_req} to "%nl%&fCost:%nl%%last color of name of {esencjalawy}%%{_n}% %name of {esencjalawy}%"
	set {_req2} to "<##ffe17a>%{_n2}% Cosmic Flux"
	set {_reqitem2} to {_n2}
	set {_lore} to "%{_req}%%nl%%{_req2}%"
	return {_lore}
function HasItemTrait(p: player, n: number, n2: number) :: boolean:
	if {language::%{_p}%} = "English":
		if {elementCard::%{_p}%} = "Ice" or "Lód":
			set {_reqitem} to {_n} of {esencjaloduEN}
		if {elementCard::%{_p}%} = "Water" or "Woda":
			set {_reqitem} to {_n} of {esencjawodyEN}
		if {elementCard::%{_p}%} = "Fire" or "Ogień":
			set {_reqitem} to {_n} of {esencjaogniaEN}
		if {elementCard::%{_p}%} = "Dark" or "Mrok":
			set {_reqitem} to {_n} of {esencjamrokuEN}
		if {elementCard::%{_p}%} = "Lava" or "Lawa":
			set {_reqitem} to {_n} of {esencjalawyEN}
	else:
		if {elementCard::%{_p}%} = "Ice" or "Lód":
			set {_reqitem} to {_n} of {esencjalodu}
		if {elementCard::%{_p}%} = "Water" or "Woda":
			set {_reqitem} to {_n} of {esencjawody}
		if {elementCard::%{_p}%} = "Fire" or "Ogień":
			set {_reqitem} to {_n} of {esencjaognia}
		if {elementCard::%{_p}%} = "Dark" or "Mrok":
			set {_reqitem} to {_n} of {esencjamroku}
		if {elementCard::%{_p}%} = "Lava" or "Lawa":
			set {_reqitem} to {_n} of {esencjalawy}
	set {_req2} to "<##ffe17a>%{_n2}% Cosmic Flux"
	set {_reqitem2} to {_n2}
	if {_p} has {_reqitem}:
		if {cosmicflux::%{_p}%} >= {_reqitem2}:
			set {_bool} to true
		else:
			set {_bool} to false
	else:
		set {_bool} to false
	return {_bool}
on inventory click:
	if event-inventory = metadata tag "traitupgrade" of player:
		cancel event
		if {language::%player%} = "English":
			if lore of event-slot contains "&fClick to upgrade this Trait":
				set {_line1::*} to (uncolored line 4 of lore of event-slot split at " ")
				set {_amount} to ({_line1::1} parsed as number)
				set {_item} to "%{_line1::2}% %{_line1::3}%"
				loop all items in the inventory of player:
					if name of loop-item contains {_item}:
						set {_item} to 1 of loop-item
						stop loop
				set {_line2::*} to (uncolored line 5 of lore of event-slot split at " ")
				set {_amount2} to ({_line2::1} parsed as number)
				remove {_amount} of {_item} from player
				remove {_amount2} from {cosmicflux::%player%}
				set {_r} to {kartaname::%player%}
				set {_id} to line 18 of lore of {karta::%player%}
				add 1 to {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%}
				loop {trait::%{_id}%::*}:
					if loop-value contains {traitupgradechat::%player%}:
						set {_num} to loop-index
				add 1 to {trait::%{_id}%::%{_num}%}
				if {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%} = 2:
					set {_text} to "<##0070dd>Rare"
				else if {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%} = 3:
					set {_text} to "<##a335ee>Epic"
				else if {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%} = 4:
					set {_text} to "<##ff8000>Legendary"
				send "&7&o%{traitupgradechat::%player%}% upgraded to %{_text}% &7quality!" to player
				send "&7&oIt is advised, albeit not needed to relog after upgrading your Traits!" to player
				play sound "azerite.collect" with volume 1 and pitch 1 at player
			else:
				play sound "block.glass.break" with volume 3 and pitch 2 to player
		else:
			if lore of event-slot contains "&fKliknij, by ulepszyć ten Trait":
				set {_line1::*} to (uncolored line 4 of lore of event-slot split at " ")
				set {_amount} to ({_line1::1} parsed as number)
				set {_item} to "%{_line1::2}% %{_line1::3}%"
				loop all items in the inventory of player:
					if name of loop-item contains {_item}:
						set {_item} to 1 of loop-item
						stop loop
				set {_line2::*} to (uncolored line 5 of lore of event-slot split at " ")
				set {_amount2} to ({_line2::1} parsed as number)
				remove {_amount} of {_item} from player
				remove {_amount2} from {cosmicflux::%player%}
				set {_r} to {kartaname::%player%}
				set {_id} to line 18 of lore of {karta::%player%}
				add 1 to {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%}
				loop {trait::%{_id}%::*}:
					if loop-value contains {traitupgradechat::%player%}:
						set {_num} to loop-index
				add 1 to {trait::%{_id}%::%{_num}%}
				if {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%} = 2:
					set {_text} to "<##0070dd>Rzadkiej"
				else if {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%} = 3:
					set {_text} to "<##a335ee>Epickiej"
				else if {trait::%{_r}%::%{traitupgradechat::%player%}%::%player%} = 4:
					set {_text} to "<##ff8000>Legendarnej"
				send "&7&o%{traitupgradechat::%player%}% został ulepszony %{_text}% &7jakości!" to player
				send "&7&oZalecane jest (lecz niewymagane) przelogowanie się po ulepszeniu swoich Traits!" to player
				play sound "azerite.collect" with volume 1 and pitch 1 at player
			else:
				play sound "block.glass.break" with volume 3 and pitch 2 to player
		set {_id} to line 18 of lore of {karta::%player%}
		if player's chestplate is a gold nugget:
			if line 30 of lore of player's chestplate contains player's name:
				loop lore of player's chestplate:
					add 1 to {_index}
					if loop-value contains {traitupgradechat::%player%}:
						set {_lo} to line {_index} of lore of player's chestplate
						set {_tr} to {traitupgradechat::%player%}
						if {trait::%{kartaname::%player%}%::%%::%player%} = 1:
							set {_color} to "<##00ff00>%{_tr}%"
						if {trait::%{kartaname::%player%}%::%{_tr}%::%player%} = 2:
							set {_color} to "<##0070dd>%{_tr}%"
						if {trait::%{kartaname::%player%}%::%{_tr}%::%player%} = 3:
							set {_color} to "<##a335ee>%{_tr}%"
						if {trait::%{kartaname::%player%}%::%{_tr}%::%player%} = 4:
							set {_color} to "<##ff8000>%{_tr}%"
						replace all "<##00ff00>%{traitupgradechat::%player%}%" in {_lo} with {_color}
						replace all "<##0070dd>%{traitupgradechat::%player%}%" in {_lo} with {_color}
						replace all "<##a335ee>%{traitupgradechat::%player%}%" in {_lo} with {_color}
						replace all "<##ff8000>%{traitupgradechat::%player%}%" in {_lo} with {_color}
						set line {_index} of lore of player's chestplate to {_lo}
						set {hearttrait::%player%::%{_index}-7%} to {_color}
						set {trait::%{_id}%::%{_index}-7%} to {_color}
		clear {traitupgradechat::%player%}
		teleport the player to player's location
on chat:
	if {traitupgradechat::%player%} is true:
		cancel event
		set {_r} to {kartaname::%player%}
		if {traits::%{_r}%::*} contains message:
			set {traitupgradechat::%player%} to message
			if {language::%player%} = "English":
				set metadata tag "traitupgrade" of player to chest inventory with 3 rows named "&0Upgrade Traits"
				set {_rank} to {trait::%{_r}%::%message%::%player%}
				set {_lore1} to "%nl%&7&oThis trait starts at Rank 1%nl%&7&oand has no cost."
				if {_rank} is 1:
					set {_rankuppossible} to "low"
					set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
				if {_rank} is 2:
					set {_rankuppossible} to "low2"
				else if {_rank} is not set:
					set {_rankuppossible} to "notknown"
				if {_rankuppossible} is not set:
					set {_loreadd} to "&fAlready known"
				else if {_rankuppossible} = "notknown":
					set {_loreadd} to "&cTrait not known"
				else if {_rankuppossible} = "low":
					set {_loreadd1} to "&cUpgrade this Trait to Rare%nl%&cquality in order to unlock%nl%&cthis upgrade."
					set {_loreadd2} to "&cUpgrade this Trait to Epic%nl%&cquality in order to unlock%nl%&cthis upgrade."
				else if {_rankuppossible} = "low2":
					set {_loreadd2} to "&cUpgrade this Trait to Epic%nl%&cquality in order to unlock%nl%&cthis upgrade."
					if {_rank} < 3:
						if HasItemTrait(player, 4, 750) is true:
							set {_loreadd1} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
						else:
							set {_loreadd1} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
					else:
						set {_loreadd} to "&fAlready known"
				if {_loreadd2} is not set:
					set slot 10 of metadata tag "traitupgrade" of player to lime glass pane named "<##00ff00>Rank 1" with lore "&7Uncommon" and {_lore1} and " " and {_loreadd}
					set {_lore} to LoreTraitUpgrade(player, 3, 500)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 2:
							if HasItemTrait(player, 3, 500) is true:
								set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
							else:
								set {_loreadd} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
						else:
							set {_loreadd} to "&fAlready known"
					set slot 12 of metadata tag "traitupgrade" of player to blue glass pane named "<##0070dd>Rank 2" with lore "&7Rare" and {_lore} and " " and {_loreadd}
					set {_lore} to LoreTraitUpgrade(player, 4, 750)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 3:
							if HasItemTrait(player, 4, 750) is true:
								set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
							else:
								set {_loreadd} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
						else:
							set {_loreadd} to "&fAlready known"
					set slot 14 of metadata tag "traitupgrade" of player to purple glass pane named "<##a335ee>Rank 3" with lore "&7Epic" and {_lore} and " " and {_loreadd}
					if {_rankuppossible} is not "notknown":
						if {_rank} < 4:
							if HasItemTrait(player, 5, 1000) is true:
								set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
							else:
								set {_loreadd} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
						else:
							set {_loreadd} to "&fAlready known"
					set {_lore} to LoreTraitUpgrade(player, 5, 1000)
					set slot 16 of metadata tag "traitupgrade" of player to orange glass pane named "<##ff8000>Rank 4" with lore "&7Legendary" and {_lore} and " " and {_loreadd}
				else:
					set slot 10 of metadata tag "traitupgrade" of player to lime glass pane named "<##00ff00>Rank 1" with lore "&7Uncommon" and {_lore1} and " " and "&fAlready known"
					set {_lore} to LoreTraitUpgrade(player, 3, 500)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 2:
							if HasItemTrait(player, 3, 500) is true:
								set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
							else:
								set {_loreadd} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
						else:
							set {_loreadd} to "&fAlready known"
					set slot 12 of metadata tag "traitupgrade" of player to blue glass pane named "<##0070dd>Rank 2" with lore "&7Rare" and {_lore} and " " and {_loreadd}
					set {_lore} to LoreTraitUpgrade(player, 4, 750)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 3:
							if HasItemTrait(player, 4, 750) is true:
								set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
							else:
								set {_loreadd} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
						else:
							set {_loreadd} to "&fAlready known"
					set slot 14 of metadata tag "traitupgrade" of player to purple glass pane named "<##a335ee>Rank 3" with lore "&7Epic" and {_lore} and " " and {_loreadd1}
					set {_lore} to LoreTraitUpgrade(player, 5, 1000)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 4:
							if HasItemTrait(player, 5, 1000) is true:
								set {_loreadd} to "&fClick to upgrade this Trait%nl%&fto a higher quality."
							else:
								set {_loreadd} to "&cYou don't have enough%nl%&cresources to upgrade this%nl%&cTrait."
						else:
							set {_loreadd} to "&fAlready known"
					set slot 16 of metadata tag "traitupgrade" of player to orange glass pane named "<##ff8000>Rank 4" with lore "&7Legendary" and {_lore} and " " and {_loreadd2}
				open metadata tag "traitupgrade" of player to player
				play sound "azerite.collect" with volume 1 and pitch 1 at player
			else:
				set metadata tag "traitupgrade" of player to chest inventory with 3 rows named "&0Ulepszanie Traitów"
				set {_rank} to {trait::%{_r}%::%message%::%player%}
				set {_lore1} to "%nl%&7&oTen Trait zaczyna na Randze 1%nl%&7&oi nie ma kosztu."
				if {_rank} is 1:
					set {_rankuppossible} to "low"
					set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
				if {_rank} is 2:
					set {_rankuppossible} to "low2"
				else if {_rank} is not set:
					set {_rankuppossible} to "notknown"
				if {_rankuppossible} is not set:
					set {_loreadd} to "&fUlepszono"
				else if {_rankuppossible} = "notknown":
					set {_loreadd} to "&cTrait nieposiadany"
				else if {_rankuppossible} = "low":
					set {_loreadd1} to "&cUlepsz ten Trait do Rzadkiej%nl%&cjakości, by odblokować%nl%&cto ulepszenie."
					set {_loreadd2} to "&cUlepsz ten Trait do Epickiej%nl%&cjakości, by odblokować%nl%&cto ulepszenie."
				else if {_rankuppossible} = "low2":
					set {_loreadd2} to "&cUlepsz ten Trait do Epickiej%nl%&cjakości, by odblokować%nl%&cto ulepszenie."
					if {_rank} < 3:
						if HasItemTrait(player, 4, 750) is true:
							set {_loreadd1} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
						else:
							set {_loreadd1} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
					else:
						set {_loreadd} to "&fUlepszono"
				if {_loreadd2} is not set:
					set slot 10 of metadata tag "traitupgrade" of player to lime glass pane named "<##00ff00>Ranga 1" with lore "&7Nieczęsty" and {_lore1} and " " and {_loreadd}
					set {_lore} to LoreTraitUpgrade(player, 3, 500)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 2:
							if HasItemTrait(player, 3, 500) is true:
								set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
							else:
								set {_loreadd} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
						else:
							set {_loreadd} to "&fUlepszono"
					set slot 12 of metadata tag "traitupgrade" of player to blue glass pane named "<##0070dd>Ranga 2" with lore "&7Rzadki" and {_lore} and " " and {_loreadd}
					set {_lore} to LoreTraitUpgrade(player, 4, 750)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 3:
							if HasItemTrait(player, 4, 750) is true:
								set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
							else:
								set {_loreadd} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
						else:
							set {_loreadd} to "&fUlepszono"
					set slot 14 of metadata tag "traitupgrade" of player to purple glass pane named "<##a335ee>Ranga 3" with lore "&7Epicki" and {_lore} and " " and {_loreadd}
					if {_rankuppossible} is not "notknown":
						if {_rank} < 4:
							if HasItemTrait(player, 5, 1000) is true:
								set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
							else:
								set {_loreadd} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
						else:
							set {_loreadd} to "&fUlepszono"
					set {_lore} to LoreTraitUpgrade(player, 5, 1000)
					set slot 16 of metadata tag "traitupgrade" of player to orange glass pane named "<##ff8000>Ranga 4" with lore "&7Legendarny" and {_lore} and " " and {_loreadd}
				else:
					set slot 10 of metadata tag "traitupgrade" of player to lime glass pane named "<##00ff00>Ranga 1" with lore "&7Uncommon" and {_lore1} and " " and "&fUlepszono"
					set {_lore} to LoreTraitUpgrade(player, 3, 500)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 2:
							if HasItemTrait(player, 3, 500) is true:
								set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
							else:
								set {_loreadd} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
						else:
							set {_loreadd} to "&fUlepszono"
					set slot 12 of metadata tag "traitupgrade" of player to blue glass pane named "<##0070dd>Ranga 2" with lore "&7Rzadki" and {_lore} and " " and {_loreadd}
					set {_lore} to LoreTraitUpgrade(player, 4, 750)
					if {_rankuppossible} is not "notknown":
						if {_rank} < 3:
							if HasItemTrait(player, 4, 750) is true:
								set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
							else:
								set {_loreadd} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
						else:
							set {_loreadd} to "&fUlepszono"
					set slot 14 of metadata tag "traitupgrade" of player to purple glass pane named "<##a335ee>Ranga 3" with lore "&7Epicki" and {_lore} and " " and {_loreadd1}
					if {_rankuppossible} is not "notknown":
						if {_rank} < 4:
							if HasItemTrait(player, 5, 1000) is true:
								set {_loreadd} to "&fKliknij, by ulepszyć ten Trait%nl%&fdo wyższej jakości."
							else:
								set {_loreadd} to "&cNie masz wystarczajacej%nl%&cilości zasobów, by ulepszyć%nl%&cten Trait."
						else:
							set {_loreadd} to "&fUlepszono"
					set {_lore} to LoreTraitUpgrade(player, 5, 1000)
					set slot 16 of metadata tag "traitupgrade" of player to orange glass pane named "<##ff8000>Ranga 4" with lore "&7Legendarny" and {_lore} and " " and {_loreadd2}
				open metadata tag "traitupgrade" of player to player
				play sound "azerite.collect" with volume 1 and pitch 1 at player	
		else:
			clear {traitupgradechat::%player%}
			if {language::%player%} = "English":
				send "<##a0dffa>>>> Trait %message% does not exist or does not belong to %{_r}%." to player
				play sound "block.glass.break" with volume 3 and pitch 2 to player
			else:
				send "<##a0dffa>>>> Trait %message% nie istnieje, lub nie należy do %{_r}%." to player
				play sound "block.glass.break" with volume 3 and pitch 2 to player
	if {traitchat::%player%} is true:
		cancel event
		set {traitchat::%player%} to message
		if player's chestplate is golden nugget:
			if player's chestplate's name contains "Heart of Earthcraft" or "Serce Earthcrafta":
				if line 30 of lore of player's chestplate contains player's name:
					if {traits::%{kartaname::%player%}%::*} contains {traitchat::%player%}:		#sprawdza czy nazwa traitu istnieje i czy nasza obecna karta posiada dany trait
						if {trait::%{kartaname::%player%}%::%{traitchat::%player%}%::%player%} is set: 			#sprawdza czy gracz posiada dany trait, np {trait::Glaceon::Whiteout::%player%}
							if {trait::%{kartaname::%player%}%::%{traitchat::%player%}%::%player%} = 1:
								set {_color} to "<##00ff00>%{traitchat::%player%}%"
							if {trait::%{kartaname::%player%}%::%{traitchat::%player%}%::%player%} = 2:
								set {_color} to "<##0070dd>%{traitchat::%player%}%"
							if {trait::%{kartaname::%player%}%::%{traitchat::%player%}%::%player%} = 3:
								set {_color} to "<##a335ee>%{traitchat::%player%}%"
							if {trait::%{kartaname::%player%}%::%{traitchat::%player%}%::%player%} = 4:
								set {_color} to "<##ff8000>%{traitchat::%player%}%"
							if {language::%player%} = "English":
								send "<##a0dffa>>>> Selected trait &r%{_color}%<##a0dffa>." to player
							else:
								send "<##a0dffa>>>> Wybrano trait &r%{_color}%<##a0dffa>." to player
							loop {hearttrait::%player%::*}:
								if loop-value contains {_color}:
									add 1 to {_c}
							if {_c} is smaller than or equal to 2:
								set {hearttrait::%player%::%{traitslot::%player%}%} to {_color}
							else if {_c} is not set:
								set {hearttrait::%player%::%{traitslot::%player%}%} to {_color}
							else:
								if {language::%player%} = "English":
									send "<##a0dffa>>>> You cannot equip more than 3 of the same Trait." to player
								else:
									send "<##a0dffa>>>> Nie możesz mieć więcej niż 3 tego samego Traitu." to player
								play sound "block.glass.break" with volume 3 and pitch 0 to player
								stop
							#play sound "entity.player.levelup" with volume 3 and pitch 0.6 to player
							set {_uncolored} to uncolored {traitchat::%player%}
							set {_hoe} to gold nugget named name of player's chestplate
							add nbt compound from "{CustomModelData:10}" to nbt of {_hoe}
							set {_ownership} to line 30 of lore of player's chestplate
							loop lore of player's chestplate:
								add 1 to {_loopnumber}
								if {_loopnumber} = 7:
									stop loop
								else:
									set {_%{_loopnumber}%} to loop-value
							loop {_loopnumber} times:
								if {_%loop-number%} is set:
									if {_%loop-number%} is not " " or "":
										add {_%loop-number%} to lore of {_hoe}
										if loop-number = 6:
											add " " to lore of {_hoe}
									else:
										if loop-number is 7:
											add {_%loop-number%} to lore of {_hoe}
							set {_id} to line 18 of lore of {karta::%player%}
							if 54 > {heartlevel::%player%}:
								clear {hearttrait::%player%::8}
							loop 12 times:
								if {hearttrait::%player%::%loop-number%} is set:
									#set {_numbers::*} to 1, 6, 13, 21, 29, 36, 45, 54, 61, 70, 78 and 86
									#replace all "&7- Unlocked at Heart Level %{_numbers}%" and "&7- Odblokowuje się na Poziomie Serca %{_numbers}%" in line (7 + loop-number) of lore of {_hoe} with "&f%{%uncolored {hearttrait::%player%::%loop-number%}%}% %{hearttrait::%player%::%loop-number%}%"
									#replace all "&f- A new power is available." and "&f- Nowa moc jest dostępna." in line (7 + loop-number) of lore of {_hoe} with "&f%{%uncolored {hearttrait::%player%::%loop-number%}%}% %{hearttrait::%player%::%loop-number%}%"
									set line (7 + loop-number) of lore of {_hoe} to "&f%{%uncolored {hearttrait::%player%::%loop-number%}%}% %{hearttrait::%player%::%loop-number%}%"
									set {trait::%{_id}%::%loop-number%} to {hearttrait::%player%::%loop-number%}
								else:
									if loop-number = 1:
										if {heartlevel::%player%} >= 1:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 1"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 1"
									if loop-number = 2:
										if {heartlevel::%player%} >= 6:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 6"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 6"
									if loop-number = 3:
										if {heartlevel::%player%} >= 13:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 13"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 13"
									if loop-number = 4:
										if {heartlevel::%player%} >= 21:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 21"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 21"
									if loop-number = 5:
										if {heartlevel::%player%} >= 29:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 29"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 29"
									if loop-number = 6:
										if {heartlevel::%player%} >= 36:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 36"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 36"
									if loop-number = 7:
										if {heartlevel::%player%} >= 45:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 45"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 45"
									if loop-number = 8:
										if {heartlevel::%player%} >= 54:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 54"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 54"
									if loop-number = 9:
										if {heartlevel::%player%} >= 61:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 61"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 61"
									if loop-number = 10:
										if {heartlevel::%player%} >= 70:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 70"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 70"
									if loop-number = 11:
										if {heartlevel::%player%} >= 78:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 78"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 78"
									if loop-number = 12:
										if {heartlevel::%player%} >= 86:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&f- A new power is available."
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&f- Nowa moc jest dostępna."
										else:
											if {language::%player%} = "English":
												set line (7 + loop-number) of lore of {_hoe} to "&7- Unlocked at Heart Level 86"
											else:
												set line (7 + loop-number) of lore of {_hoe} to "&7- Odblokowuje się na Poziomie Serca 86"
								if loop-number = 12:
									stop loop
								if {traitslot::%player%} = loop-number:
									set line (7 + loop-number) of lore of {_hoe} to "&f%{%{_uncolored}%}% %{_color}%"
							if {_bezlinijki} is true:
								add "<##00ff00>Equip: Harnesses the energy of raw" and "<##00ff00>Azerite, awakening exceptional pieces" and "<##00ff00>of armor that possess latent powers." and " " and "<##fdd002>''A living symbol of hope, borne by the" and "<##fdd002>champions of a dying planet. The fate" and "<##fdd002>of Earthcraft will be shared by all its" and "<##fdd002>children.''" and "<##00ff00><Shift Right Click to View Traits>" to lore of {_hoe}
							else:
								add " " and "<##00ff00>Equip: Harnesses the energy of raw" and "<##00ff00>Azerite, awakening exceptional pieces" and "<##00ff00>of armor that possess latent powers." and " " and "<##fdd002>''A living symbol of hope, borne by the" and "<##fdd002>champions of a dying planet. The fate" and "<##fdd002>of Earthcraft will be shared by all its" and "<##fdd002>children.''" and "<##00ff00><Shift Right Click to View Traits>" to lore of {_hoe}
							add {_ownership} to lore of {_hoe}
							set player's chestplate to {_hoe}
							clear {traitslot::%player%}
							play sound "azerite.rotate" with volume 2 and pitch 1 at player
							wait 2 seconds
							set {_r} to a random integer between 1 and 3
							stop sound "azerite.rotate" for player
							play sound "azerite.trait_select" with volume 2 and pitch 1 at player
						else:
							if {language::%player%} = "English":
								send "<##a0dffa>>>> You don't own the &f%{traitchat::%player%}% <##a0dffa>trait." to player
							else:
								send "<##a0dffa>>>> Nie posiadasz traitu &f%{traitchat::%player%}%<##a0dffa>." to player
							play sound "block.glass.break" with volume 3 and pitch 0 to player
					else:
						if {language::%player%} = "English":
							send "<##a0dffa>>>> Trait &f%{traitchat::%player%}% <##a0dffa>does not exist." to player
						else:
							send "<##a0dffa>>>> Trait &f%{traitchat::%player%}% <##a0dffa>nie istnieje." to player
						play sound "block.glass.break" with volume 3 and pitch 0 to player
			else:
				if {language::%player%} = "English":
					send "<##a0dffa>>>> You must have <##e8ce81>Heart of Earthcraft <##a0dffa>equipped to do this." to player
				else:
					send "<##a0dffa>>>> Musisz mieć założone <##a0dffa>Serce Earthcrafta by móc to zrobić." to player
				play sound "block.glass.break" with volume 3 and pitch 0 to player
					

function TraitMob(p: player):
	if {_p} is a player:
		set {_chance} to a random integer between 1 and 100
		#GLOWING AZERITE CRYSTAL
		if {_chance} is between 1 and 2.5:
			set {_r} to a random integer between 200 and 300
			HeartLevelup({_p}, {_r})
		#GLOWING AZERITE
		else if {_chance} is between 3.5 and 4.5:
			set {_r} to a random integer between 300 and 350
			HeartLevelup({_p}, {_r})
		#SMALL AZERITE CLUSTER
		else if {_chance} is between 4.5 and 9.5:
			set {_r} to a random integer between 150 and 200
			HeartLevelup({_p}, {_r})
		#SMALL AZERITE SHARD
		else if {_chance} is between 9.5 and 29.5:
			set {_r} to a random integer between 50 and 100
			HeartLevelup({_p}, {_r})
		#TINY AZERITE SPLINTER
		else if {_chance} is between 29.5 and 69.5:
			set {_r} to a random integer between 1 and 50
			HeartLevelup({_p}, {_r})
		#GLOWING AZERITE GEODE
		else if {_chance} is between 69.5 and 69.7:
			set {_r} to a random integer between 425 and 500
			HeartLevelup({_p}, {_r})
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Vaporeon":
					if {trait::Vaporeon::Downpour::%{_p}%} is not set:
						if {trait::Vaporeon::Downpour::%{_p}%} is not set:
							set {_color} to "<##00ff00>Downpour" 		#RANK 1
						add 1 to {trait::Vaporeon::Downpour::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Downpour}% %{_color}%&6! &6(<##7cafbf>Vaporeon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Downpour}% %{_color}%&6! &6(<##7cafbf>Vaporeon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Vaporeon":
					if {trait::Vaporeon::High Tide::%{_p}%} is not set:
						if {trait::Vaporeon::High Tide::%{_p}%} is not set:
							set {_color} to "<##00ff00>High Tide" 		#RANK 1
						add 1 to {trait::Vaporeon::High Tide::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{High Tide}% %{_color}%&6! &6(<##7cafbf>Vaporeon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{High Tide}% %{_color}%&6! &6(<##7cafbf>Vaporeon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Vaporeon":
					if {trait::Vaporeon::Hydrodance::%{_p}%} is not set:
						if {trait::Vaporeon::Hydrodance::%{_p}%} is not set:
							set {_color} to "<##00ff00>Hydrodance" 		#RANK 1
						add 1 to {trait::Vaporeon::Hydrodance::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Hydrodance}% %{_color}%&6! &6(<##7cafbf>Vaporeon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Hydrodance}% %{_color}%&6! &6(<##7cafbf>Vaporeon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Ghazan":
					if {trait::Ghazan::Lava Imbued::%{_p}%} is not set:
						if {trait::Ghazan::Lava Imbued::%{_p}%} is not set:
							set {_color} to "<##00ff00>Lava Imbued" 		#RANK 1
						add 1 to {trait::Ghazan::Lava Imbued::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Lava Imbued}% %{_color}%&6! &6(<##b03228>Ghazan&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Lava Imbued}% %{_color}%&6! &6(<##b03228>Ghazan&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Ghazan":
					if {trait::Ghazan::Mountains Will Fall::%{_p}%} is not set:
						if {trait::Ghazan::Mountains Will Fall::%{_p}%} is not set:
							set {_color} to "<##00ff00>Mountains Will Fall" 		#RANK 1
						add 1 to {trait::Ghazan::Mountains Will Fall::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Mountains Will Fall}% %{_color}%&6! &6(<##b03228>Ghazan&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Mountains Will Fall}% %{_color}%&6! &6(<##b03228>Ghazan&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Ghazan":
					if {trait::Ghazan::Lava Resurgence::%{_p}%} is not set:
						if {trait::Ghazan::Lava Resurgence::%{_p}%} is not set:
							set {_color} to "<##00ff00>Lava Resurgence" 		#RANK 1
						add 1 to {trait::Ghazan::Lava Resurgence::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Lava Resurgence}% %{_color}%&6! &6(<##b03228>Ghazan&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Lava Resurgence}% %{_color}%&6! &6(<##b03228>Ghazan&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Glaceon":
					if {trait::Glaceon::Wintertide::%{_p}%} is not set:
						if {trait::Glaceon::Wintertide::%{_p}%} is not set:
							set {_color} to "<##00ff00>Wintertide" 		#RANK 1
						add 1 to {trait::Glaceon::Wintertide::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Wintertide}% %{_color}%&6! &6(<##4bbfe2>Glaceon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Wintertide}% %{_color}%&6! &6(<##4bbfe2>Glaceon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Glaceon":
					if {trait::Glaceon::Splintering Cold::%{_p}%} is not set:
						if {trait::Glaceon::Splintering Cold::%{_p}%} is not set:
							set {_color} to "<##00ff00>Splintering Cold" 		#RANK 1
						add 1 to {trait::Glaceon::Splintering Cold::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Splintering Cold}% %{_color}%&6! &6(<##4bbfe2>Glaceon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Splintering Cold}% %{_color}%&6! &6(<##4bbfe2>Glaceon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Glaceon":
					if {trait::Glaceon::Frozen Touch::%{_p}%} is not set:
						if {trait::Glaceon::Frozen Touch::%{_p}%} is not set:
							set {_color} to "<##00ff00>Frozen Touch" 		#RANK 1
						add 1 to {trait::Glaceon::Frozen Touch::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Frozen Touch}% %{_color}%&6! &6(<##4bbfe2>Glaceon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Frozen Touch}% %{_color}%&6! &6(<##4bbfe2>Glaceon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Delphox":
					if {trait::Delphox::Blaster Master::%{_p}%} is not set:
						if {trait::Delphox::Blaster Master::%{_p}%} is not set:
							set {_color} to "<##00ff00>Blaster Master" 		#RANK 1
						add 1 to {trait::Delphox::Blaster Master::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Blaster Master}% %{_color}%&6! &6(<##d74327>Delphox&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Blaster Master}% %{_color}%&6! &6(<##d74327>Delphox&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Delphox":
					if {trait::Delphox::Firefall::%{_p}%} is not set:
						if {trait::Delphox::Firefall::%{_p}%} is not set:
							set {_color} to "<##00ff00>Firefall" 		#RANK 1
						add 1 to {trait::Delphox::Firefall::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Firefall}% %{_color}%&6! &6(<##d74327>Delphox&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Firefall}% %{_color}%&6! &6(<##d74327>Delphox&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Delphox":
					if {trait::Delphox::Pyroclasm::%{_p}%} is not set:
						if {trait::Delphox::Pyroclasm::%{_p}%} is not set:
							set {_color} to "<##00ff00>Pyroclasm" 		#RANK 1
						add 1 to {trait::Delphox::Pyroclasm::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Pyroclasm}% %{_color}%&6! &6(<##d74327>Delphox&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Pyroclasm}% %{_color}%&6! &6(<##d74327>Delphox&6)" to {_p}
						play sound "entity.attacker.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Umbreon":
					if {trait::Umbreon::Replicating Shadows::%{_p}%} is not set:
						if {trait::Umbreon::Replicating Shadows::%{_p}%} is not set:
							set {_color} to "<##00ff00>Replicating Shadows" 		#RANK 1
						add 1 to {trait::Umbreon::Replicating Shadows::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Replicating Shadows}% %{_color}%&6! &6(<##555555>Umbreon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Replicating Shadows}% %{_color}%&6! &6(<##555555>Umbreon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Umbreon":
					if {trait::Umbreon::Subtlety::%{_p}%} is not set:
						if {trait::Umbreon::Subtlety::%{_p}%} is not set:
							set {_color} to "<##00ff00>Subtlety" 		#RANK 1
						add 1 to {trait::Umbreon::Subtlety::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Subtlety}% %{_color}%&6! &6(<##555555>Umbreon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Subtlety}% %{_color}%&6! &6(<##555555>Umbreon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
		chance of 0.08%:
			if {osiagniecie.heart::%{_p}%} = true:
				if {kolekcja::karty::%{_p}%::*} contains "Umbreon":
					if {trait::Umbreon::Night Embrace::%{_p}%} is not set:
						if {trait::Umbreon::Night Embrace::%{_p}%} is not set:
							set {_color} to "<##00ff00>Night Embrace" 		#RANK 1
						add 1 to {trait::Umbreon::Night Embrace::%{_p}%}
						if {language::%{_p}%} = "English":
							send "&8[&6Earthcraft&8] &6Unlocked trait: &f%{Night Embrace}% %{_color}%&6! &6(<##555555>Umbreon&6)" to {_p}
						else:
							send "&8[&6Earthcraft&8] &6Odblokowano trait: &f%{Night Embrace}% %{_color}%&6! &6(<##555555>Umbreon&6)" to {_p}
						play sound "entity.{_p}.levelup" with volume 5 and pitch 1.2 at {_p}
on leave:
	clear {traitchat::%player%}
	clear {traitslot::%player%}
	clear {traitupgradechat::%player%}
	
on join:
	if {haste::%player%} < 0:
		set {haste::%player%} to 0
	if {poziom::%player%} >= 40:
		if {criticalhit::%player%} is not set:
			if {haste::%player%} is not set:
				if {mastery::%player%} is not set:
					if {health::%player%} is not set:
						if name of player's chestplate contains "Heart of Earthcraft":
							if player's chestplate is a golden nugget:
								set {_health::*} to (uncolored line 3 of lore of player's chestplate) split at " "
								replace all "+" in {_health::1} with ""
								set {_health} to {_health::1} parsed as number
								set {_staty::*} to (uncolored line 4 of lore of player's chestplate) split at " "
								replace all "+" in {_staty::1} with ""
								set {_staty::1} to {_staty::1} parsed as number
								set {healthheart::%player%} to {_health}
								set {statyheart::%player%} to {_staty::1}
								add {_health} to {health::%player%}
								add {_staty::1} to {criticalhit::%player%}
								add {_staty::1} to {haste::%player%}
								add {_staty::1} to {mastery::%player%}
								set max health of player to 25 + ({health::%player%}/5)
								set scaled health of player to 10
								
	

on region enter:
	if "%region%" contains "ChamberEntrance":
		play sound "ambient.chamber_of_heart" with volume 5 and pitch 1 to player
		wait 143 seconds
		set {_x} to "%region at player%"
		while {_x} contains "ChamberEntrance" or "ChamberofHeart":
			set {_x} to "%region at player%"
			play sound "ambient.chamber_of_heart" with volume 5 and pitch 1 to player
			stop loop if {_x} does not contain "ChamberEntrance" or "ChamberofHeart"
			wait 143 seconds

on region exit:
	if "%region%" contains "ChamberofHeart":
		stop sound "ambient.chamber_of_heart" for player

on region enter:
	if "%region%" contains "Spawn":
		if {poziom::%player%} >= 40:
			if {heartofec::%player%} is not set:
				wait 2 seconds
				if {language::%player%} = "English":
					send "<##7aa7f5>! &8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>The entrance to the chamber is to the right of the exit from the oasis. Let's meet there!" to player
				else:
					send "<##7aa7f5>! &8[<##7aa7f5>NPC&8] &8<<##7aa7f5>Magni&8> <##7aa7f5>Wejście na dół jest po prawej od wyjścia z oazy. Spotkajmy się tam!" to player
				play sound "block.note_block.cow_bell" with volume 5 and pitch 1 to player
				play sound "entity.lightning_bolt.thunder" with volume 5 and pitch 0 to player
				play sound "entity.lightning_bolt.thunder" with volume 5 and pitch 1 to player
				play sound "entity.lightning_bolt.impact" with volume 5 and pitch 1.6 to player

#Otwiera się gui przy kliknięciu na Magnia kartą, każda karta ma 12 slotów na traity, można max 3x lub max 4x danego traitu
#każdy trait dodaje się do listy, kliknięcie załóżmy slotu #1 otworzy listę wszystkich odblokowanych traitów
#z tej listy możemy wybrać który trait chcemy dać na ten slot, duplikaty trzeba odblokowywać osobno?
#gdy odblokujemy trait, następna linijka HoE to &7Odblokowuje się na 15 poziomie Serca